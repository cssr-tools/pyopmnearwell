

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Configuration file &mdash; pyopmnearwell  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=e59714d7" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="author" title="About these documents" href="about.html" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Examples" href="examples.html" />
    <link rel="prev" title="Installation" href="installation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search"  style="background: #aaaaaa" >

          
          
          <a href="index.html">
            
              <img src="_static/logo.png" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Configuration file</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#reservoir-related-parameters">Reservoir-related parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#rock-related-parameters">Rock-related parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="#well-related-parameters">Well-related parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="api.html">pyopmnearwell Python API</a></li>
<li class="toctree-l1"><a class="reference internal" href="output_folder.html">Output folder</a></li>
<li class="toctree-l1"><a class="reference internal" href="contributing.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="related.html">Related</a></li>
<li class="toctree-l1"><a class="reference internal" href="about.html">About pyopmnearwell</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu"  style="background: #aaaaaa" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">pyopmnearwell</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Configuration file</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/configuration_file.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="configuration-file">
<h1>Configuration file<a class="headerlink" href="#configuration-file" title="Link to this heading"></a></h1>
<p>The following configuration file is available in the <a class="reference external" href="https://github.com/cssr-tools/pyopmnearwell/blob/main/examples">examples</a> folder
in the GitHub repository as co2.toml and in the <a class="reference internal" href="examples.html"><span class="doc">examples</span></a> documentation section the simulation results are shown.</p>
<p>The first input parameter in the configuration file is:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="c1">#Set mpirun, the full path to the flow executable, and simulator flags (except --output-dir)</span>
<span class="linenos">2</span><span class="n">flow</span> <span class="o">=</span> <span class="s2">&quot;flow --relaxed-max-pv-fraction=0 --enable-opm-rst-file=true --newton-min-iterations=1 --enable-tuning=true&quot;</span>
</pre></div>
</div>
<p>If <strong>flow</strong> is not in your path, then write the full path to the executable, as well as adding mpirun
if this is supported in your machine (e.g., flow = “mpirun -np 8 /Users/dmar/Github/opm/build/opm-simulators/bin/flow –relaxed-max-pv-fraction=0”).</p>
<section id="reservoir-related-parameters">
<h2>Reservoir-related parameters<a class="headerlink" href="#reservoir-related-parameters" title="Link to this heading"></a></h2>
<p>The following input lines are:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 4</span><span class="c1">#Set the model parameters</span>
<span class="linenos"> 5</span><span class="n">model</span> <span class="o">=</span> <span class="s2">&quot;co2store&quot;</span> <span class="c1">#Model: co2store, co2eor, foam, h2store, or saltprec</span>
<span class="linenos"> 6</span><span class="n">template</span> <span class="o">=</span> <span class="s2">&quot;base&quot;</span> <span class="c1">#Template file (see src/pyopmnearwell/templates/)</span>
<span class="linenos"> 7</span><span class="n">grid</span> <span class="o">=</span> <span class="s2">&quot;cake&quot;</span> <span class="c1">#Grid type: cake, radial, core, cartesian2d, coord2d, tensor2d, cartesian, cpg3d, coord3d, or tensor3d</span>
<span class="linenos"> 8</span><span class="n">adim</span> <span class="o">=</span> <span class="mi">60</span> <span class="c1">#Grid cake/radial: theta [degrees]; core: input/output pipe length [m]; cartesian2d, coord2d, tensor2d: width[m]</span>
<span class="linenos"> 9</span><span class="n">xdim</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1">#Length [m] (for cartesian/cpg3d/coord3d/tensor3d, Length=Width=2*xdim)</span>
<span class="linenos">10</span><span class="n">xcn</span> <span class="o">=</span> <span class="p">[</span><span class="mi">80</span><span class="p">]</span> <span class="c1">#Number of x-cells [-]; coordinates for grid type coord2d/coord3d [m]; numbers of x-cells for grid type tensor2d/tensor3d [-]</span>
<span class="linenos">11</span><span class="n">xfac</span> <span class="o">=</span> <span class="mi">2</span> <span class="c1">#Exponential factor for the telescopic x-gridding (0 to use an equidistant partition)</span>
<span class="linenos">12</span><span class="n">diameter</span> <span class="o">=</span> <span class="mf">0.1</span> <span class="c1">#Well diameter [m]</span>
<span class="linenos">13</span><span class="n">pressure</span> <span class="o">=</span> <span class="mi">100</span> <span class="c1">#Pressure [Bar] on the top</span>
<span class="linenos">14</span><span class="n">temperature</span> <span class="o">=</span> <span class="p">[</span><span class="mi">40</span><span class="p">,</span><span class="mi">40</span><span class="p">]</span> <span class="c1">#Top and bottom temperatures [C]</span>
<span class="linenos">15</span><span class="n">initialphase</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#Initial phase in the reservoir (0 wetting, 1 non-wetting)</span>
<span class="linenos">16</span><span class="n">pvmult</span> <span class="o">=</span> <span class="mf">1e10</span> <span class="c1">#Pore volume multiplier on the boundary [-] (-1 to ignore; 0 to use well producers instead)</span>
<span class="linenos">17</span><span class="n">perforations</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">]</span> <span class="c1">#Activate perforations [-], number of well perforations [-], and length [m]</span>
<span class="linenos">18</span><span class="n">hysteresis</span> <span class="o">=</span> <span class="s2">&quot;Killough&quot;</span> <span class="c1">#Add hysteresis (Killough or Carlson, 0 by default, i.e., no hysteresis)</span>
<span class="linenos">19</span><span class="n">zxy</span> <span class="o">=</span> <span class="s2">&quot;2-2*mt.cos((2*mt.pi*x/50)) + 10*(x/100)**2&quot;</span> <span class="c1">#The function for the reservoir surface</span>
</pre></div>
</div>
<p>Here we first select the physical model and the corresponding template. To add additional models (e.g., blackoil), one could look at the
<a class="reference external" href="https://github.com/OPM/opm-tests">opm-tests</a> decks, convert the necessary input decks and files to mako
templates, add them to the src/pyopmnearwell/templates folder, and extending the Python scripts in the
src/pyopmnearwell/utils folder. In the following line we select type of grid and the second entry defines the length of the inlet/outlet tubes for the core,
theta aperture for the radial/cake/coord2d/tensord2d grids, the width of the cells for the cartesian2d grid, or it is ignored for the 3D cartesian grids (the width and number of cells is set equal to
the ones in the x directions). See/Run the <a class="reference external" href="https://github.com/cssr-tools/pyopmnearwell/blob/main/tests/geometries">tests/geometries</a> configuration files for these grids.
Then we set the length of the reservoir, as well as the number of grid elements in the x direction (for the y/theta direction we use the ‘adim’ variable
with exception to the core/3D grids where the width and number of cells is set equal to the ones in the z/x directions). The xfac entry defines the exponential factor for the telescopic serie used to generate the x partition (if
set to 0 then an equidistance partition is generated).</p>
<figure class="align-default" id="id1">
<img alt="_images/gridding.png" src="_images/gridding.png" />
<figcaption>
<p><span class="caption-text">Four different grids by setting the line ‘grid’ and ‘adim’ to ‘radial’ ‘36’ (top left, showing the depth), ‘cake’ ‘60’ (top right, showing the y-direction cell size),
‘cartesian2d’ ‘1’ (bottom left, showing the x-direction cell size), and ‘cartesian’ (bottom right, showing the cell pore volume).</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-default" id="id2">
<img alt="_images/core.png" src="_images/core.png" />
<figcaption>
<p><span class="caption-text">Example of core geometry (generated by running the examples/h2core.toml configuration file).</span><a class="headerlink" href="#id2" title="Link to this image"></a></p>
</figcaption>
</figure>
<p>We then define additional parameters for the reservoir properties, as described in each configuration file.</p>
</section>
<section id="rock-related-parameters">
<h2>Rock-related parameters<a class="headerlink" href="#rock-related-parameters" title="Link to this heading"></a></h2>
<p>The following entries define the rock related parameters:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">21</span><span class="c1">#Set the saturation functions</span>
<span class="linenos">22</span><span class="n">krw</span> <span class="o">=</span> <span class="s2">&quot;krw * ((sw - swi) / (1.0 - sni -swi)) ** nkrw&quot;</span>        <span class="c1">#Wetting rel perm saturation function [-]</span>
<span class="linenos">23</span><span class="n">krn</span> <span class="o">=</span> <span class="s2">&quot;krn * ((1.0 - sw - sni) / (1.0 - sni - swi)) ** nkrn&quot;</span> <span class="c1">#Non-wetting rel perm saturation function [-]</span>
<span class="linenos">24</span><span class="n">pcap</span> <span class="o">=</span> <span class="s2">&quot;pen * ((sw - swi) / (1.0 - swi)) ** (-(1.0 / npen))&quot;</span> <span class="c1">#Capillary pressure saturation function [Bar]</span>
</pre></div>
</div>
<p>In this example we consider properties for the sands number 2 to 5 as described in the
<a class="reference external" href="https://www.spe.org/en/csp/">11th SPE CSP</a>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">26</span><span class="c1">#Properties sat functions: 1) swi [-], 2) sni [-], 3) krw [-], 4) krn [-], 5) pen [Bar], 6) nkrw [-], 7) nkrn [-],</span>
<span class="linenos">27</span><span class="c1">#8) npen [-], 9) threshold cP evaluation, 10) ignore swi for cP? (sl* for cplog) (entry per layer, if hysteresis, additional entries per layer)</span>
<span class="linenos">28</span><span class="n">safu</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">0.14</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">8655e-5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">29</span><span class="p">[</span><span class="mf">0.12</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">6120e-5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">30</span><span class="p">[</span><span class="mf">0.12</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">3871e-5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">31</span><span class="p">[</span><span class="mf">0.12</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">3060e-5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">32</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">33</span><span class="p">[</span><span class="mf">0.14</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">8655e-5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">34</span><span class="p">[</span><span class="mf">0.12</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">6120e-5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">35</span><span class="p">[</span><span class="mf">0.12</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">3871e-5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">36</span><span class="p">[</span><span class="mf">0.12</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">3060e-5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">,</span><span class="mi">0</span><span class="p">],</span>
<span class="linenos">37</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">,</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
<p>Since the ‘activate perforations option’ is set to 1, then we add an extra line after the 4 rock properties
to define the ones in the perforations (Line 32). Since the hysteresis option is activated, then the
imbibition saturation functions are defined by adding as many additional lines as number of rocks (+1
if the perforations are activated, lines 33 to 37 in this example).</p>
<p>Now for the rock properties:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">39</span><span class="c1">#Properties rock: 1) Kxy [mD], 2) Kz [mD], 3) phi [-], 4) thickness [m], and 5) no cells in the z dir [-] (entry per layer)</span>
<span class="linenos">40</span><span class="n">rock</span> <span class="o">=</span> <span class="p">[[</span><span class="mf">101.324</span><span class="p">,</span><span class="mf">10.1324</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
<span class="linenos">41</span><span class="p">[</span><span class="mf">202.650</span><span class="p">,</span><span class="mf">20.2650</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
<span class="linenos">42</span><span class="p">[</span><span class="mf">506.625</span><span class="p">,</span><span class="mf">50.6625</span><span class="p">,</span><span class="mf">0.2</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
<span class="linenos">43</span><span class="p">[</span><span class="mf">1013.25</span><span class="p">,</span><span class="mf">101.325</span><span class="p">,</span><span class="mf">0.25</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span>
<span class="linenos">44</span><span class="p">[</span><span class="mf">2013.25</span><span class="p">,</span><span class="mf">201.325</span><span class="p">,</span><span class="mf">0.45</span><span class="p">]]</span>
</pre></div>
</div>
<p>As seen from the previous values, the finnest sand corresponds to the top one and it gets coarser
towards the bottom. The last two entries define the z size of the layer and number of cells,
while for the perforations these have the thickness of one single cell.</p>
</section>
<section id="well-related-parameters">
<h2>Well-related parameters<a class="headerlink" href="#well-related-parameters" title="Link to this heading"></a></h2>
<p>Now we proceed to define the schedule for the injection well. Here the injection well is located from the
top to the bottom on the left side of the domain and the injection is given as kg/day:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">46</span><span class="c1">#Define the injection values (entry per change in the schedule):</span>
<span class="linenos">47</span><span class="c1">#1) injection time [d], 2) time step size to write results [d], 3) maximum time step [d]</span>
<span class="linenos">48</span><span class="c1">#4) fluid (0 wetting, 1 non-wetting), 5) injection rates [kg/day]</span>
<span class="linenos">49</span><span class="n">inj</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">7</span><span class="p">,</span><span class="mf">1e-1</span><span class="p">,</span><span class="mf">5e-2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">57611.52</span><span class="p">],</span>
<span class="linenos">50</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mf">1e-1</span><span class="p">,</span><span class="mf">5e-2</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">57611.52</span><span class="p">],</span>
<span class="linenos">51</span><span class="p">[</span><span class="mi">7</span><span class="p">,</span><span class="mf">1e-1</span><span class="p">,</span><span class="mf">5e-2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">57611.52</span><span class="p">]]</span>
</pre></div>
</div>
<p>Here CO2 (non-wetting phase) is injected for seven days printing the results 70 times and limmiting the time step
to 5e-2 days, after water (wetting phase) is injected for the same period at the same mass rate, and finally CO2 is
reinjected for the same period.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="installation.html" class="btn btn-neutral float-left" title="Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="examples.html" class="btn btn-neutral float-right" title="Examples" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023-2025, NORCE Norwegian Research Centre AS.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>